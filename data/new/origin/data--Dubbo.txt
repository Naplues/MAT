//  IMPORTANT! For async scenario, we must remove context from current thread, so we always create a new RpcContext for the next invoke for the same thread. 
//  TODO: 2017/8/30 to move somewhere else better 
//  FIXME: now we need to check first, then load 
//  TODO Context.SESSIONS is the best option here? (In jetty 9.x, it becomes ServletContextHandler.SESSIONS) 
//  TODO move names to Constants 
// ignore concurrent problem? 
// TODO add this to provider config 
//  special treatment of array values was suggested by 'lizongbo' 
//  TODO we should leave this setting to slf4j 
//  FIXME: when the thread pool is full, SERVER_THREADPOOL_EXHAUSTED_ERROR cannot return properly,   therefore the consumer side has to wait until gets timeout. This is a temporary solution to prevent   this scenario from happening, but a better solution should be considered later. 
//  The initial value is null and the midway may be assigned to null, please use the local variable reference 
//  FIXME REQUEST_CONTEXT 
// is it possible to go here ? 
//  for example, object transported on the wire doesn't implement Serializable 
// bug: DUBBO-425 
//  FIXME log error message in Codec and handle in caught() of IoHanndler? 
// There may be some problem handling chinese (negative number recognition). Ignoring this problem, the backspace key is only meaningfully input in a real telnet program. 
/*       This UT is unstable, consider remove it later.      @see https://github.com/apache/dubbo/issues/1787      */
//  bug: DUBBO-132 
//  TODO do more sophisticated exception handling and output 
/*  * TODO for now kryo serialization doesn't deny classes that don't implement the serializable interface * * <pre> *     e.g. &lt;dubbo:protocol serialization="kryo" /&gt; * </pre>  */
//  DELIM_START was escaped, thus should not be incremented 
//  TODO users can override this mapper, but we just rely on the current priority strategy of resteasy 
// FIXME: waiting for embedded Nacos suport, then we can open the switch. 
// TODO generic invoker？ 
/*      * FIXME, this instance will always be a type of DynamicConfiguration, ConfigCenterConfig will load the instance at startup and assign it to here.      */
//  TODO Do not want to use spaces? See: DUBBO-502, URL class handles special conventions for special characters. 
//  should destroy resource? 
//  hack, use reflection to get the shared channel.
//  TODO Notification failure does not restore mechanism guarantee 
// TODO fix npe  context.isProviderSide(); 
// TODO we needs use force writing to file so that buffer gets clear and new log can be written. 
// Reselect before retry to avoid a change of candidate `invokers`.  NOTE: if `invokers` changed, then `invoked` also lose accuracy. 
/*  * TODO load as SPI will be better?  */
// fixme, reject exception can not be sent to consumer because thread pool is full, resulting in consumers waiting till timeout. 
/*  * TODO refactor using mockito  */
//  generally a client can only be closed once, here it is closed twice, counter is incorrect 
// TODO A temporary solution to the problem that the exception information can not be sent to the opposite end after the thread pool is full. Need a refactoring  fix The thread pool is full, refuses to call, does not return, and causes the consumer to wait for time out 
//  TODO in the future maybe we can just use a single rest client and connection manager 
//  Caution!! 
// TODO solve merge problem  = Constants.DEFAULT_STUB_EVENT; 
//  FIXME: a hack to make org.apache.dubbo.remoting.exchange.support.DefaultFuture.closeChannel work 
/*  is the buffer big enough?  */
//  BUG: DUBBO-846 in version 2.0.9, config retry="false" on provider's method doesn't work 
//  FIXME: this exposes the design flaw in RouterChain 
//  FIXME RESPONSE_CONTEXT 
//  TODO jetty will by default enable keepAlive so the xml config has no effect now 
// cannot write == not Available ? 
//  TODO Wrapper cannot handle this scenario correctly: the classname contains '$' 
//  On server side, thrift can not handle exceptions not declared in idl 
// TODO assert error log 
/*  * This class represents an unfinished RPC call, it will hold some context information for this call, for example RpcContext and Invocation, * so that when the call finishes and the result returns, it can guarantee all the contexts being recovered as the same as when the call was made * before any callback is invoked. * <p> * TODO if it's reasonable or even right to keep a reference to Invocation? * <p> * As {@link Result} implements CompletionStage, {@link AsyncRpcResult} allows you to easily build a async filter chain whose status will be * driven entirely by the state of the underlying RPC call. * <p> * AsyncRpcResult does not contain any concrete value (except the underlying value bring by CompletableFuture), consider it as a status transfer node. * {@link #getValue()} and {@link #getException()} are all inherited from {@link Result} interface, implementing them are mainly * for compatibility consideration. Because many legacy {@link Filter} implementation are most possibly to call getValue directly.  */
//  FIXME should put exception in future? 
//  DUBBO-571 methods key in provider's URLONE doesn't contain the methods from inherited super interface 
/*  * ContextFilterTest.java * TODO need to enhance assertion  */
//  FIXME: this code looks useless 
//  TODO due to dubbo's current architecture,   it will be called from registry protocol in the shutdown process and won't appear in logs 
//  TODO can we load successfully for a different classloader?. 
// The status input has a problem, and the read information is wrong when the serialization is serialized. 
//  FIXME: not sure why AbstractReferenceConfig has both isGeneric and getGeneric 
//  FIXME result is an AsyncRpcResult instance. 
//  FIXME, should cancel and restart timer tasks if parameters in the new URL are different? 
/*  * TODO Extract more code here if necessary  */
//  FIXME RMI protocol doesn't support casting to EchoService yet. 
//  dubbo's original impl can't support the use of ServletContext          server.addHandler(servletHandler); 
//  Deprecated! Subscribe to override rules in 2.6.x or before. 
//  Subscribe the override data   FIXME When the provider subscribes, it will affect the scene : a certain JVM exposes the service and call    the same service. Because the subscribed is cached key with the name of the service, it causes the 
/*      * Should be called after Config was fully initialized.     * // FIXME: this method should be completely replaced by appendParameters     *     * @return     * @see AbstractConfig#appendParameters(Map, Object, String)     * <p>     * Notice! This method should include all properties in the returning map, treat @Parameter differently compared to appendParameters.      */
// TODO Can the value returned by getChannel() be null? need improvement. 
//  TODO, to support wildcards 
//  FIXME: cannot guarantee the sequence of the merge result, check implementation in   MergeableClusterInvoker#invoke 
//  FIXME Is there any need of failing back to Constants.ANY_VALUE or the first available method invokers when invokers is null? 
//  TODO more configs to add 
//  BuG: DUBBO-146 Provider doesn't have exception output, and consumer has timeout error when serialization fails
//  FIXME There's no place to release connectionExecutor! 
//  TODO: refactor it 
//  If every invoker has the same weight? 
/*  * TODO this may not be a pretty elegant solution, *  */
//  FIXME log error info in Codec and put all error handle logic in IoHanndler? 
//  can't shutdown nioEventLoopGroup because the method will be invoked when closing one channel but not a client,   but when and how to close the nioEventLoopGroup ?   nioEventLoopGroup.shutdownGracefully(); 
/*  * FIXME: is this really necessary? PropertiesConfiguration should have already covered this: * @see PropertiesConfiguration * @See ConfigUtils#getProperty(String)  */
/*      * the resident routers must being initialized before address notification.     * FIXME: this method should not be public      */
//  TODO there may have duplicate refresh 
// fixme replace this with better method 
//  TODO for now we don't consider the differences of encoding and server limit 
/*      * FIXME check @Parameter(required=true) and any conditions that need to match.      */
/*           RMI needs extra parameter since it uses customized remote invocation object          The customized RemoteInvocation was firstly introduced in v2.6.3; The package was renamed to 'org.apache.*' since v2.7.0          Considering the above two conditions, we need to check before sending customized RemoteInvocation:          1. if the provider version is v2.7.0 or higher, send 'org.apache.dubbo.rpc.protocol.rmi.RmiRemoteInvocation'.          2. if the provider version is v2.6.3 or higher, send 'com.alibaba.dubbo.rpc.protocol.rmi.RmiRemoteInvocation'.          3. if the provider version is lower than v2.6.3, does not use customized RemoteInvocation.          */
//  TODO exist concurrent gap 
//  TODO: 2017/8/31 FIXME The thread pool should be used to refresh the address, otherwise the task may be accumulated. 
/*      * If there's no dynamic tag rule being set, use static tag in URL.     * <p>     * A typical scenario is a Consumer using version 2.7.x calls Providers using version 2.6.x or lower,     * the Consumer should always respect the tag in provider URL regardless of whether a dynamic tag rule has been set to it or not.     * <p>     * TODO, to guarantee consistent behavior of interoperability between 2.6- and 2.7+, this method should has the same logic with the TagRouter in 2.6.x.     *     * @param invokers     * @param url     * @param invocation     * @param <T>     * @return      */
//  Construct using org.apache.dubbo.common.serialize.protobuf.support.MapValue.Map.newBuilder() 
//  1. No service provider 2. Service providers are disabled 
//  closing closed means the process is being closed and close is finished 
//  get data length. 
//  The monitoring center is responsible for deleting outdated dirty data 
//  Key-Value pair, stores both match and mismatch conditions 
//  -default is not included 
//  allow string arg to enum type, @see PojoUtils.realize0() 
//  check length. 
//         assertEquals(echo.$echo("test"), "test");          assertEquals(echo.$echo("abcdefg"), "abcdefg");          assertEquals(echo.$echo(1234), 1234); 
/*  translate stored positions  */
// final int length = PerformanceUtils.getIntProperty("length", 1024); 
//  Dubbo RPC protocol version, for compatibility, it must not be between 2.0.10 ~ 2.6.2
//  desc2name 
//  The parameters of the test service query need to be with the providermerge.
//  for test 
//  for the exception not found in method's signature, print ERROR message in server's log. 
// yyline = yychar = yycolumn = 0; 
//  Use PBResponseType.newBuilder() to construct. 
//  check duplicated candidate bean 
// mark the future is sent 
//  Remove async property to avoid being passed to the following invoke chain. 
//  should not override
//  This should never happen;
//  other thread cancel this timeout or stop the timer. 
/* invoker = protocol.refer( Demo.class, url );        Assertions.assertNotNull( invoker );        RpcInvocation invocation = new RpcInvocation();        invocation.setMethodName( "echoString" );        invocation.setParameterTypes( new Class<?>[]{ String.class } );        String arg = "Hello, World!";        invocation.setArguments( new Object[] { arg } );        Result result = invoker.invoke( invocation );        Assertions.assertEquals( arg, result.getResult() ); */
//  "[[Ljava/lang/Object;" ==> "[[Ljava.lang.Object;" 
//  search in caller's classloader 
//  logging output 
// Boundary condition test . 
/*  first: make room (if you can)  */
//  concurrent cache initialization 
//  parameters 
//  test timeout of lease 
//  When starting the subscription center, 
// Check whether the mock value is legal 
//  take first one 
//  null out prev, next and bucket to allow for GC. 
//  Resolve placeholders 
//  TEST Pb Service metaData builder 
//  Start reconnection timer 
//  If the Config Center is given the highest priority, it will override all the other configurations 
// |10011111|20-stats=ok|id=0|length=0 
//  begin to construct a NullPointerException with empty stackTrace 
// Merged with this configuration 
//  Healthy Instances 
//  for test validation 
//  ============================A gorgeous line of segmentation================================================ 
// private int port; 
//  ~ end of method decode 
//   If the server side has synchronized data, just write a single machine 
//  check for required fields   check for sub-struct validity 
//  test recover 
//  since security manager is not installed.
//  parameter fields 
//  The parameters of the provider for the inspection service need merge
/*  If the Config Center product you use have some special parameters that is not covered by this class, you can add it to here.    For example, with XML:      <dubbo:config-center>           <dubbo:parameter key="{your key}" value="{your value}" />      </dubbo:config-center>      */
//  Restore any other contexts in here if necessary.
// cancel a future 
//  If the bean is not initialized, invoke init()   issue: https://github.com/apache/dubbo/issues/3429 
//  callback method when async-call has exception thrown 
// check format of pattern 
//  test all methods 
//  ================== Util methods ================== 
//  ======================================================     invoker related data preparing 
//  from api 
//  Should remain unchanged. 
// Check the index of current selected invoker, if it's not the last one, choose the one at index+1. 
//  Map<serviceName, List<notificationListener>> 
// argument type 
// default base64. 
//  Record the index of the least active invoker in leastIndexes order 
//  G for GET, and P for POST 
//  1 : 9 : 6 
//  callback method when async-call is invoked 
//  write header. 
//  copy reference 
//  as proto3 only accept one protobuf parameter 
//  First, try picking a invoker not in `selected`. 
//  throw demo exception
//  set category 
//  merge override parameters 
// SPI should be get from SpiExtensionFactory
//  update registry 
// test multiple urls 
/*  (non-Javadoc)         * @see org.apache.dubbo.remoting.transport.support.ChannelHandlerAdapter#caught(org.apache.dubbo.remoting.Channel, java.lang.Throwable)          */
//  decode object. 
//  create 
//  fall back to use method getResourceAsStream 
//  add constructors 
//  Notify the other threads waiting for the initialization at start(). 
//  skip test. 
//  Check the file change 
//  if "getName" method is absent 
//  update local exporter 
//  Ignore those fields 
//  save bind port, used as url's key later 
//  ~ end of method destroy 
//  impl constructor 
//  For test purpose 
//  AbstractChannelBuffer 
//  handle nested generic type 
//                  ^^^^^^^ Caution , parse as host 
//  Local disk cache, where the special key value.registries records the list of registry centers, and the others are the list of notified service providers 
// Initial value 0 
//  If you only have a single redis, you need to take a rest to avoid overtaking a lot of CPU resources 
//  service not found.
// private int yycolumn; 
//  callback method when async-call is returned 
//  Reset the number of least active invokers 
//  if it's declared as local reference   'scope=local' is equivalent to 'injvm=true', injvm will be deprecated in the future release 
// change recycle time to 1 ms 
//  The KV part of the condition expression 
//  multicast ipv6 address, 
//  .addParameter("refer.autodestroy", "true") 
//  Any exception will be ignored to handle 
//  only for attachments 
//  check deleted invoker 
//  guess version fro jar file name if nothing's found from MANIFEST.MF 
//  skip multicast registry since we cannot connect to it via Socket 
//     public List<URL> getBackupUrls() {          List<org.apache.dubbo.common.URL> res = super.getBackupUrls();          return res.stream().map(url -> new URL(url)).collect(Collectors.toList());      } 
//  @@protoc_insertion_point(builder_scope:org.apache.dubbo.common.serialize.protobuf.model.PBResponseType) 
//  ======================================================     test Start   ====================================================== 
//  present in both local and remote, uses local url params 
//  for reuse SerializeWriter buf 
//  Bean compare 
//  If (not every invoker has the same weight & at least one invoker's weight>0), select randomly based on    totalWeight. 
//  check against type and superclasses 
//  create request. 
//  trim the leading "/" 
//  timeout after 5 seconds. 
//  add invocationid in async operation by default 
//  Appends value array attributes 
//  just add urls which needs retry. 
//  Optional 
/*  user code:  */
//  Append backup parameter as other servers 
//     public PropertyInjector getPropertyInjector() {          return propertyInjector;      } 
//  Get invokers from cache, only runtime routers will be executed. 
//  store back cached position 
//  Use default configs defined explicitly on global configs 
//  doesn't need to distinguish version for callback 
//  Register @Reference Annotation Bean Processor 
//  @@protoc_insertion_point(builder_scope:org.apache.dubbo.common.serialize.protobuf.model.PBRequestType) 
//  allow repeats in siblings 
//  test group 
//  create Proxy class. 
// zzAtBOL  = true; 
//  If override url is not enabled or is invalid, just return. 
//  this is a defensive operation to avoid client is closed by accident, the initial state of the client is false 
//  current node 
//  report same error when get is invoked for multiple times 
//  @@protoc_insertion_point(interface_extends:org.apache.dubbo.common.serialize.protobuf.model.PBResponseType) 
//  parameter callback rule: method-name.parameter-index(starting from 0).callback 
/*  The namespace of the config center, generally it's used for multi-tenant,    but it's real meaning depends on the actual Config Center you use.     */
//  available to test 
//  no match category 
//  now just added some very common classes 
//  if it's callback service on client side 
//  directly throw if it's dubbo exception 
//  callback instance when async-call is invoked 
//  Fill the unprocessedTimeouts so we can return them from stop() method. 
//  since the rule can be changed by config center, we should copy one to use. 
//  Null Point check 
//  get status. 
//  init table. 
//  this UT maybe only works on particular platform, assert only when value is not null. 
//  At least one single machine is available. 
//  ~ end of loop method map 
//  default deregister critical server after 
//  encode response data or error message. 
//         this.context = context;      }        public String getContext() {          return context;      } 
//  Because it's a strictly round robin, so the abs delta should be < 10 too 
//  header. 
//  should output cost or not 
//  @@protoc_insertion_point(builder_implements:org.apache.dubbo.common.serialize.protobuf.model.PhoneNumber) 
//  confirm only 1 register success 
//  should not happen here 
//  this only works for servlet containers 
//  column definition 
//  it can be invoke successfully 
//  check pong at client 
//  create new decode table. 
//  Integer representation of value 
//  if only one empty 
/*  Linux Pause  */
// force:direct mock 
// ignore concurrency problem 
//  prevents grpc on sending watchResponse to a closed watch client. 
//  the sumInvoker1 : sumInvoker2 approximately equal to 1: 9 
//  #5 ReferenceBean (Field Injection #3) 
//  add imported packages 
/*      * <p>Repeat a String {@code repeat} times to form a     * new String, with a String separator injected each time. </p>     *     * <pre>     * StringUtils.repeat(null, null, 2) = null     * StringUtils.repeat(null, "x", 2)  = null     * StringUtils.repeat("", null, 0)   = ""     * StringUtils.repeat("", "", 2)     = ""     * StringUtils.repeat("", "x", 3)    = "xxx"     * StringUtils.repeat("?", ", ", 3)  = "?, ?, ?"     * </pre>     *     * @param str       the String to repeat, may be null     * @param separator the String to inject, may be null     * @param repeat    number of times to repeat str, negative treated as zero     * @return a new String consisting of the original String repeated,     * {@code null} if null String input     * @since 2.5      */
//  <ip:port, channel> 
//  init task and start timer. 
//  generic invocation is not local reference 
/*                  *  if we have no interface watcher listener,                 *  find the current listener or create one for the current root, put or get only once.                  */
/*                                                  *  if new interface event arrived, we watch their direct children,                                                 *  eg: /dubbo/interface, /dubbo/interface and so on.                                                  */
//  check if notify successfully 
//  full list of addresses from registry, classified by method name. 
//  List<U> urls = mockRegistry.getSubscribedUrls(); 
// java.sql.Date 
//  TODO for now just do xml output 
//  check for primitive array types because they   unfortunately cannot be cast to Object[] 
// r times [sleep] r 10 or r 10 100 
//  Request a non-exists method
// release mina resouces. 
//         Thread.sleep(100000); 
// verifyExporterUrlGeneration(regConfForService, regConfForServiceTable); 
/*  Used to specify the key that your properties file mapping to, most of the time you do not need to change this parameter.    Notice that for Apollo, this parameter is meaningless, set the 'namespace' is enough.     */
//  ================ complex POJO ============= 
//  echo(int) 
//  The sum of weights 
//  cast to EchoService 
//  end construct a NullPointerException with empty stackTrace 
// test multiple unregisters 
//  did not find parameter in URL type 
//  TODO protocol 
// can't find command 
//  Every invoker has the same weight? 
//  loop up before registry 
//  Rely on reconnect timer to reconnect when AbstractClient.doConnect fails to init the connection 
//  data to collect from url 
//  normal case 
//  Initialization at the time of injection, the assertion is not null   Initialization at the time of injection, the assertion is not null 
//  duplicated jar is found
//  from system property 
//  tell tomcat to fail on startup failures. 
//  Use PBRequestType.newBuilder() to construct. 
//  The least active value of all invokers 
//  it's a generic reference 
/*  Windows Ctrl+C  */
//  double check to avoid dup close 
//  ======== Reference config default values, will take effect if reference's attribute is not set  ======== 
//  onResponse callback 
//  close once, counter counts down from 2 to 1, no warning occurs 
//  if no failed report, wait how many times to run retry task. 
//  magic 
//     private Map<String, String> extraHttpHeaders	= new HashMap<String, String>(); 
//  For testing purposes only 
//  SUCCESS 
//  still init for the same ReferenceConfig if the cache is different 
//  not a registry url, must be direct invoke. 
//  property of custom type or primitive type 
//  Register center address 
//  check if there's duplicated jar 
//  default value 
//  weightTestRpcStatus3 active is 1 
//  Not equal 
//  no match service interface 
//  process implemented interfaces 
// Make sure that the subscribe call has just been called once count.incrementAndGet after the call is completed  Wait for the timer. 
//  dubbo check 
//  double byte char 
//  Close all invokers 
//  ---- service statistics ----   invocation cost   current concurrent count 
//  FIXME 
//  present in local url but not in remote url 
//  From Ancestor 
//  backward compatibility 
//  set magic number. 
// ignore error 
//  message 
/* url = url.addParameter( "echoString." + Constants.TIMEOUT_KEY, Integer.MAX_VALUE );        invoker = protocol.refer( Demo.class, url );        org.junit.jupiter.api.Assertions.assertNotNull( invoker );        RpcInvocation invocation = new RpcInvocation();        invocation.setMethodName( "echoString" );        invocation.setParameterTypes( new Class<?>[]{ String.class } );        String arg = "Hello, World!";        invocation.setArguments( new Object[] { arg } );                invocation.setAttachment(Constants.INTERFACE_KEY, DemoImpl.class.getName());        Result result = invoker.invoke( invocation );        Assertions.assertNull( result.getResult() );        Assertions.assertTrue( result.getException() instanceof RpcException ); */
//  asert empty 
//  If a Key has no corresponding Value, then the Key also used as the Value. 
//  Requires JDK 7 or higher, Foo<int[]> is no longer GenericArrayType 
//  check && override if necessary 
//  ReferenceBean should be initialized and get immediately 
// add 300ms to ensure that the delayService has been exported 
//  Growth of skipping times   If the number of skipping times increases by more than 10, take the random number 
//  Read port from property 
//  Tag request 
//  "name" property is present 
// this.listener = listener; 
// .addParameter(Constants.ON_DISCONNECT_KEY, "disconnect") 
//           ReferenceAnnotationBeanPostProcessor beanPostProcessor = context.getBean(BEAN_NAME,                  ReferenceAnnotationBeanPostProcessor.class);              Map<InjectionMetadata.InjectedElement, ReferenceBean<?>> referenceBeanMap =                  beanPostProcessor.getInjectedMethodReferenceBeanMap();   
//  send heartbeat when read idle. 
//  If the serialization key is json or fastjson 
//  can use thrift codec only 
//  @@protoc_insertion_point(builder_scope:Map) 
//  2 invokers=================================== 
//  If a task should be canceled we put this to another queue which will be processed on each tick.   So this means that we will have a GC latency of max. 1 tick duration which is good enough. This way 
//  verify save group, save error 
//  "Ljava/lang/Object;" ==> "java.lang.Object" 
//         this.propertyInjector = factory.getInjectorFactory().createPropertyInjector(getScannableClass(), factory); 
//  we need to read the local cache file for future Registry fault tolerance processing.
//  this.listener = null; 
//  registry port, not used as bind port by default 
//  directly throw if it's JDK exception 
//         invoker.destroy(); 
//  Hessian2  
//  register first 
//  NetUtils.getLocalHost is the ip address consumer registered to registry. 
// Check whether the mock class is a implementation of the interfaceClass, and if it has a default constructor 
/*  * ScriptRouterFactory * <p> * Example URLS used by Script Router Factory： * <ol> * <li> script://registryAddress?type=js&rule=xxxx * <li> script:///path/to/routerfile.js?type=js&rule=xxxx * <li> script://D:\path\to\routerfile.js?type=js&rule=xxxx * <li> script://C:/path/to/routerfile.js?type=js&rule=xxxx * </ol> * The host value in URL points out the address of the source content of the Script Router，Registry、File etc *  */
//  filter by dynamic tag group first 
//  Merge the provider side parameters 
//  multiple callbacks in the method 
//  Sending a cancellation request to the server side 
//  now we don't use the 'values' map to hold these objects 
//  export to remote if the config is not local (export to local only when config is local) 
//  handshake 
// echo  
//  replace the latest "," to be ")" 
//             {"generic", "generic", "boolean", false, true, "", "", "", "", ""}, 
//  we may want to avoid exposing the dubbo exception details to certain clients 
//  if no notify URL, add empty protocol URL 
//  dubbo request id 
// this.listener = null; 
// Map interface class change to HashMap implement 
// check config conflict 
//  read one byte to guess protocol 
// Filter the parameters that do not need to be output in url(Starting with .) 
//  test default 
//  Other 
//  use global group 'dubbo' if no group specified 
//  verify compatibility when 2.0.5 invokes 2.0.3, enum in custom parameter 
//  If protocol is configured at the reference side, only the matching protocol is selected 
//  "setName" and "getName" methods are present   the param type is String   set bean name to the value of the "name" property 
/*  The config center cluster, it's real meaning may very on different Config Center products.  */
//  numRead < 0 
//  from dubbo.properties 
//  ipv4 multicast address 
//  Get PropertySource mapped to 'dubbo.properties' in Spring Environment. 
//  convert list to array 
// The exception is thrown for the first time to see if the back will be called again to incrementAndGet 
//  Nested collection or map. 
//  ARG 
//  Request timeout in milliseconds for register center 
//  If all invokers have the same weight value or totalWeight=0, return evenly. 
/*                   package was renamed to 'org.apache.dubbo' in v2.7.0, so only provider versions after v2.7.0 can                  recognize org.apache.xxx.HttpRemoteInvocation'.                  */
//  export one service first, to test connection sharing 
//  read the parameters 
//  Map<serviceName, queryString> 
// sync update cache file 
//  Add since 2.7.0 
//  return statement 
//  Customized inject-object if necessary 
//  ---- for service consumer ---- 
//  Register DubboConfigAliasPostProcessor 
//  let's rock it! 
//  Set<invokerUrls> cache invokeUrls to invokers mapping. 
//  careful 
//  max allowed execute times 
//  As long as one client is not available, you need to replace the unavailable client with the available one. 
// java.util.Date 
//  Defensive fault tolerance 
//  As `javassist` have a strict restriction of argument types, request will fail if Invocation do not contains complete parameter type information 
//  args 
//  property without generic type should not be build ex method return List 
//  padding 
//  push name. 
//  remove extra space at line's end 
//  The service has a normal sync method signature, should get future from RpcContext. 
//  check again 
//  merged from dubbox 
//             {"generic", "generic", "boolean", false, false, "", "", "", "", ""}, 
// biz error should not throw and affect biz thread.
//  unexport one service 
// impl mock 
//  @@protoc_insertion_point(builder_implements:org.apache.dubbo.common.serialize.protobuf.model.PBResponseType) 
// 00000010-response/oneway/hearbeat=false/noset |20-stats=ok|id=0|length=0 
//  Wait until the startTime is initialized by the worker. 
//  asserts aliases 
//  retry to offer the task into queue. 
//  Check and connect to the metadata 
//  send error message to Consumer, otherwise, Consumer will wait until timeout. 
// create registry by spi/ioc 
//  encoder 
//  Impossible 
//  version 1.0.0 represents Dubbo rpc protocol before v2.6.2 
//  help for gc 
//  id attribute appears since 2.7.3 
// The address you see at the registry 
//  Not in the cache, refer again 
//  Resolve placeholder 
// Allocating one in advance, this list is certain to be used. 
// ================================================================================================ 
//  check if unsubscribe successfully 
// rate or interval has changed, rebuild 
//  note: URL is value's type 
//  true means to accept foreign IP 
//             {"timeout", "registry.timeout", "int", 5000, 9000, "", "", "", "", ""},              {"file", "registry.file", "string", "", "regConfForServiceTable.log", "", "", "", "", ""},              {"wait", "registry.wait", "int", 0, 9000, "", "", "", "", ""},              {"transport", "registry.transporter", "string", "netty", "mina", "", "", "", "", ""}, 
//  Password to login register center 
//  replace ":" to "," 
//  avoid creating too many connections， so add lock 
//  init atomic reference 
//             {"version", "version", "string", "0.0.0", "1.2.3", "", "", "", "", ""},              {"group", "group", "string", "", "HaominTest", "", "", "", "", ""}, 
//  mock environment variables 
//  window system don't support ":" in file name 
//  load class 
//  no need to generate multiple exporters for different channel in the same JVM, cache key cannot collide. 
//  only used for javassist 
//  The argument must be the concrete NacosServiceName 
//  Enum property has two setting method.   skip setXXXValue(int value) 
//  Remove the expired   Defensive fault tolerance 
// init queue and executor 
//  reconnect with a delay; avoiding immediate retry on a long connection downtime. 
//  default is false 
//  trigger delete after unavailable 
//  We use 0 as an indicator for the uninitialized value here, so make sure it's not 0 when initialized. 
//  reset status since connection is shared among invokers 
//  instance will never delete or recreate. 
/*                      *  if we are interested in special categories (providers, consumers, routers and so on),                     *  we find out the current container or create one for the url, put or get only once.                      */
/*                      *  if we have no category watcher listener,                     *  we find out the current listener or create one for the current category, put or get only once.                      */
//  encode 
//  ignore 
//  range cases 
//  header length. 
/*  * TODO Comment of ProtocolUtils  */
//  item name. 
//  containing all routers, reconstruct every time 'route://' urls change. 
/*      * get unCollection unMap property name from setting method.<br/>     * ex:setXXX();<br/>     *     * @param methodName     * @return      */
//  dynamic class tag interface. 
// line 
//  ignore default attribute value 
//  Put the first least active invoker first in leastIndexes 
// prevent other UT's failure 
//  If override url has port, means it is a provider address. We want to control a specific provider with this override url, it may take effect on the specific provider instance or on consumers holding this provider instance. 
//  Make sure if it is a copied buffer. 
//  init queue and executor 
//  we must disable the debug logging for production use 
//  to false, which means it will invoke any providers without a tag unless it's explicitly disallowed. 
// RegistryServer.reloadCache(); 
//  @Parameter(key="key1", useKeyAsProperty=false) 
//  NOTE: Hessian2 throws ArrayIndexOutOfBoundsException instead of IOException, let's live with this. 
// dump every 10 minutes 
//  ======== Deprecated ======== 
//  empty protocol will default to 'dubbo' 
//  collect data 
//  The index of invokers having the same least active value (leastActive) 
//  use interface class name list as key. 
//  Map<url, Invoker> cache service url to invoker mapping. 
//  client type setting. 
//  Host 
//  <component name or id, <data-name, data-value>> 
//         Assertions.assertEquals(response.getProtocolVersion(), obj.getVersion()); 
//  The number of invokers having the same least active value (leastActive) 
//  currentPoolThreadSize >= max 
//  List<String> addresses = tagRouterRule.filter(providerApp);   return all addresses in dynamic tag group. 
//         tomcat.getConnector().setProperty(                  "minSpareThreads", String.valueOf(url.getParameter(Constants.THREADS_KEY, Constants.DEFAULT_THREADS))); 
//  write object. 
// java.sql.Timestamp 
//  Object $invoke(String method, String[] parameterTypes, Object[] args) throws GenericException; 
//  URL address separated regular expression for parsing the service provider URL list in the file cache 
//  if value doesn't change, return immediately   value != null 
//  retry task schedule period 
//  Whether the consumer's machine has only one process   Multiple processes in the same machine cannot be unicast with unicast or there will be only one process receiving information
//  ignore attribute name to skip 
// 		assertThat(result.getName(), is("abc"));  		assertThat(result.getAge(), is(30)); 
//  Process the component type of an array. 
//  If none of the invokers has a local signal, pick the first one available. 
//  pre-route and build cache, notice that route cache should build on original Invoker list. 
//  path 
// client side error 
//  parseConfigurators will recognize app/service config automatically. 
//  set codec. 
// Two different methods should always use the same invoker every time. 
//  Construct using org.apache.dubbo.common.serialize.protobuf.model.GooglePB.PhoneNumber.newBuilder() 
//  process extended super class 
//  cycle report the data switch 
// callback interface 
//  Start multiple threads 
//  4. unexport service 
//  message header length placeholder 
//  impl methods. 
/*  invalidate buffer     */
/*     } */
//  check if subscribe successfully 
//  Try to get a cached definition 
//  encode response verson ??          Assertions.assertEquals(response.getProtocolVersion(), obj.getVersion()); 
//  setup 
// Ensure that the main thread is online 
//  Disable new tasks from being submitted 
//  ~ end of loop map 
//  draw one line 
//  id MUST be present in AbstractConfig   id MUST NOT be equal to bean name   id MUST NOT be present in AliasRegistry 
//  register, subscribe, notify, unsubscribe, unregister 
//  test order 
//  output one error every 5000 invocations. 
//  1.0.0   Dubbo implementation version, usually is jar version. 
//  Check and connect to the registry 
//  check the file change 
//  it's declared as remote reference 
//  Close the unused Invoker 
//  if the type is not primitive, we choose to believe what the invoker want is a null value 
//  ======================================================     private helper 
//  #1 ReferenceBean (Method Injection #1) 
//  connect. 
//  check for required fields 
//  concurrent counter 
//  must be executed after unsubscribing 
/*   retry task map  */
//  Compatible with the old version 
// Check whether the mock value is legal, if it is illegal, throw exception 
//  When modifying the configuration through override, you need to re-expose the newly modified service. 
//             ex.printStackTrace(); 
//  get Throwable class 
//  message body 
//  no welcome output for http protocol 
//  protocol key is the second 
//  check for required fields   alas, we cannot check 'arg' because it's a primitive and you chose the non-beans generator. 
//  tab 
//  Test @Transactional is present or not 
//  Create client and build connection 
//  here is non-biz exception, wrap it. 
//  code.append("   }");   } 
//  Make sure the buffer content is independent from each other. 
//  The final root path would be: /configRootPath/"config" 
//  parse bind port from environment 
//  The lock for client acquisition process, lock the creation process of the client instance to prevent repeated clients 
//  Add the timeout to the timeout queue which will be processed on the next tick.   During processing all the queued HashedWheelTimeouts will be added to the correct HashedWheelBucket. 
//  Test my-registry2 bean presentation 
// private boolean zzEOFDone; 
//  first elements 
// decide if we need to re-publish 
//  state. 
//  Start file save timer 
//  header size 
// Content 
// fail-mock 
//  and Update 
//         url = url.addParameter( Constants.TIMEOUT_KEY, Integer.MAX_VALUE ); 
// The registry is initially pushed to override only, and the dirctory state should be false because there is no invoker. 
/*  * Default {@link HelloService} annotation with Spring's {@link Service} * and Dubbo's {@link org.apache.dubbo.config.annotation.Service} * * @since TODO  */
//  the first invoker's weight 
//  Save Error 
//  if path is not the same as interface name then we should keep INTERFACE_KEY,   otherwise, the registry structure of zookeeper would be '/dubbo/path/providers',   but what we expect is '/dubbo/interface/providers' 
// if protocol is only injvm ,not register 
//  service name 
//  com.alipay.test.TestService:1.0:group@dubbo 
//  Trim all whitespace 
//  one callback in the method 
//  we can make again use of our MpscLinkedQueue and so minimize the locking / overhead as much as possible. 
//  then unsubscribe 
/*                      * at the first time, we want to pull already category and then watch their direct children,                     *  eg: /dubbo/interface/providers, /dubbo/interface/consumers and so on.                      */
//  Timer for failure retry, regular check if there is a request for failure, and if there is, an unlimited retry 
//  The parameters of the inspection registry need to be cleared 
//  print ending separation line 
// must equal the bytes 
//  only for attachment 
//  add methods 
//  handle array generic type 
//  "java.lang.Object" ==> "Ljava.lang.Object;" 
//  for test content 
//  TODO We only care the changes happened on a specific path level, for example    /dubbo/config/dubbo/configurators, other config changes not in this level will be ignored, 
//  just for test 
//  null url 
//  create class 
/*                  *  if we are interested in all interfaces,                 *  find out the current container or create one for the url, put or get only once.                  */
//  null out prev and next to allow for GC. 
//  Build pool with SoftReferences enabled (optional) 
// final String onerror = PerformanceUtils.getProperty("onerror", "continue"); 
// object to bytearray 
//  remove module: "x.y.z" 
//         consulRegistry.destroy();          assertThat(consulRegistry.isAvailable(), is(false)); 
//  Asserts Null fields 
//  More than one methods, mismatch 
//  expect nothing happen 
//  separator 
//  providers 
//         invoker.retryFailed();// when retry the invoker which get from failed map already is not the mocked invoker,so 
//  lazy connect, need set send.reconnect = true, to avoid channel bad status. 
//  Retry another server 
// argument: index -1 represents not set 
//  Accumulate the total weight of the least active invoker 
//  2. export service and get url parameter string from db 
//  Can be null 
//  release port if used 
//  received the cancel response 
//  invoke id. 
//  Subscribed services 
//  visit all methods 
// only decode necessary bytes 
//  if protocol is not injvm checkRegistry 
//  check if the output equals the input urls 
//  convert argument type 
/*  split CIDR to address and prefix part  */
//  wait for timer to finish 
//  send readonly event when server closes, it's enabled by default 
//  Nacos use empty string as default name space, replace default namespace "dubbo" to "" 
/*                  * at the first time, we want to pull already interface and then watch their direct children,                 *  eg: /dubbo/interface, /dubbo/interface and so on.                  */
//  
//  Decide the behaviour when initial connection try fails, 'true' means interrupt the whole process once fail. 
//  method has no URL parameter 
//  version 
// test one url 
//  @@protoc_insertion_point(interface_extends:org.apache.dubbo.common.serialize.protobuf.model.PBRequestType) 
//  no need to call unexport() here, see   org.apache.dubbo.config.spring.extension.SpringExtensionFactory.ShutdownHookListener 
//  ================ final field test ================ 
//  Assertions.assertEquals("{\"code\":\"001\",\"message\":\"AAAAAAAA\"}", json); 
//                 .setAttachments(attachments)  // merged from dubbox 
// Avoid add the same invoker several times. 
// private boolean zzAtBOL = true; 
//  return default version if no version info is found 
//  verify compatibility when 2.0.5 invokes 2.0.3 
// SERVER 
// decode argument ,may be callback 
//  @@protoc_insertion_point(interface_extends:org.apache.dubbo.common.serialize.protobuf.model.PhoneNumber) 
//             ReferenceBean<?> referenceBean = entry.getValue();                assertThat(referenceBean.getModule().getName(), is("defaultModule"));              assertThat(referenceBean.getMonitor(), not(nullValue()));          }      } 
//  if not configured, connection is shared, otherwise, one connection for one service 
// Avoid collision 
// java.sql.Time 
//                             rowbuf.append(" ");                          } 
/*  error codes  */
//  NOTE: It should be determined on the business level whether the `When condition` can be empty or not.
// ====================================================== 
//         super.destroy(); 
// client can export a service which's only for server to invoke 
//  by default, go through local reference if there's the service exposed locally 
//  public field 
//  write header.   write data. 
//  subscribe first 
//  The timeout was placed into a wrong slot. This should never happen. 
//  url to registry 
//  graceful close 
//  retry again. If failed again, throw exception. 
//  backward compatibility to spring 2.0.1 
//  let's simply use url's hashcode to generate unique service id for now 
/*  Linux Enter  */
//  try to put the value 
//  user customized class 
//  jedis gets the result comparison 
//  been invoked once, it's close status is false 
//  Check whether url is to be applied to the current service 
//  default true 
//  We always return true for previously defined Router, that is, old Router doesn't support cache anymore.          return true; 
//  replace "=" to "," 
//  workerState can be 0 or 2 at this moment - let it always be 2. 
//  message flag. 
//  get the class def for obj and type 
//             {"delay", "delay", "int", 0, 5, "", "", "", "", ""}, // not boolean 
//  The parameter urls are sorted   Repeated url 
//  Put new invoker in cache 
//  no servicekey 
//  Release the lock 
//  getter method not found, throw
//  The invoker wrap relation would be: RegistryAwareClusterInvoker(StaticDirectory) -> FailoverClusterInvoker(RegistryDirectory, will execute route) -> Invoker 
//  create rpc invoker. 
//  Filter out all the least active invokers 
//  Protobuf property has two setting method.   skip setXXX(com.google.protobuf.Builder value) 
//  inner nodes cache judgement 
//  prepare 
//         ExtensionLoader.getExtensionLoader(Ext9Empty.class).getSupportedExtensions(); 
//  for previous dubbo version(2.0.10/020010~2.6.2/020602), this version is the jar's version, so they need to   be ignore 
//  Dynamic param 
// the fist element in `indexedVariables` is a set to keep all the InternalThreadLocal to remove  look at method `addToVariablesToRemove` 
//  verify listener 
// Simulation: all invokers are destroyed 
//  Save 
//  mark it's a callback, for troubleshooting 
//  try to modify the key 
// Start validation of parameter values 
//  relatedQuery error, no id and email is passed, will trigger validation exception for both Save 
// never mind if ephemeral 
//  Create clients and build connections 
//  If the clients is empty, then the first initialization is 
//  in order to avoid closing a client multiple times, a counter is used in case of connection per jvm, every   time when client.close() is called, counter counts down once, and when counter reaches zero, client will be   closed. 
//  Build and remove last ":" 
//  Set interface 
//  Load configuration from  system properties -> externalConfiguration -> RegistryConfig -> dubbo.properties 
//  Try to match one by one 
//  provider 
// init history 
//  Ignore - it will be ready very soon.
//  directly throw if exception class and interface class are in the same jar file. 
//  notify one invoker 
// throw  ChannelEventRunnable.runtimeExeception(int logger) not in execute exception 
//  find handler by message class. 
//  process constructors, fields, methods 
// The test call is independent of the path of the registry url 
//  Set 
//  log  output 
//  Since we have subscribe testUrl, here should return a empty set instead of null 
//  border 
//  remove 'default.' prefix for configs from ConsumerConfig   appendParameters(map, consumer, Constants.DEFAULT_KEY); 
//  Required 
//  volatile, please copy reference to use 
//  for backward compatibility   -Ddubbo.registry.address is now deprecated. 
//  Return a invoker based on the random value. 
//  fire event to all listeners 
//  Process parameter types. 
//  Reconnect the timer to check whether the connection is available at a time, and when unavailable, an infinite reconnection 
//  remove path: "group-module-x.y.z" 
//  save for later use 
//  Performance tuned for 2.0 (JDK1.4) 
// weight changed 
//  BIO is not allowed since it has severe performance issue. 
//  no match service version 
//  get consumer's global configuration 
//  @Parameter(exclude=true) 
//  The null value is unallowed in the ConcurrentHashMap. 
//  Ensure we don't schedule for past. 
//  tree node 
// private int yychar; 
//  since the retry task will not be very much. 128 ticks is enough. 
//  #3 ReferenceBean (Method Injection #2) 
//  ephemeral is expired 
//  @@protoc_insertion_point(class_scope:org.apache.dubbo.common.serialize.protobuf.model.PBRequestType) 
//  has one sync callback 
//  easy for mock 
//  First page data 
//  wildcard cases 
//  currently for test purpose 
//         Thread.sleep(100000);//for debug 
//  override url with configurator from "override://" URL for dubbo 2.6 and before 
//  support com.alibaba.dubbo.common.extension.Activate 
//  data rows 
// spin 
//  2.8.x is reserved for dubbox 
// do nothing 
// fix:#4585 
// not pass the condition 
//       uncomment is unblock invoking          serviceURL = serviceURL.addParameter("yyy."+Constants.ASYNC_KEY,String.valueOf(true));          consumerUrl = consumerUrl.addParameter("yyy."+Constants.ASYNC_KEY,String.valueOf(true)); 
//  mock protocol 
/*  if not: blow it up  */
// key value pair pattern. 
//  all attributes of REFER_KEY 
//  Remove all instances associated with this loader as well 
//  If the server has entered the shutdown process, reject any new connection 
//  set timeout status. 
//  From Parent 
//  This urls contain parameter and it donot inherit from the parameter of url in MultipleRegistry 
// The current, may have been merged many times 
//  setup attachment 
//  decode response. 
//  Start part of the condition expression. 
//  if a url is specified, don't do local reference 
//  available first 
// The failedsubcribe corresponding key will be cleared when unsubscribing 
//  without ROUTER_KEY, the first router should not be created. 
//  search common-used logging frameworks 
//  sorting makes it easy to compare between lists 
//  wait close done. 
//  biz exception 
//  Bind annotation attributes 
//  Max times to retry to save properties to local cache file 
// set ip 
//  inner class name include $. 
//  property of map 
//  response received, latch counts down to zero 
//  for thrift codec 
// must shutdown thread pool ,if not will lead to OOM 
//         int timeout = ConfigUtils.getServerShutdownTimeout();          Thread.sleep(timeout + 1000);          assertEquals(false, exporter.getInvoker().isAvailable()); 
//  Find all interfaces from the annotated class   To resolve an issue : https://github.com/apache/dubbo/issues/3251 
//  unrefer 
//  Cancel the reconnection timer 
//  Remote @Service Bean 
// The parameters can not be rereferenced 
//  The Value in the KV part, if Value have more than one items.   Should be separated by ',' 
// override 
// ignore 
//  The sequence would be: SystemConfiguration -> AbstractConfig -> AppExternalConfiguration -> ExternalConfiguration -> PropertiesConfiguration 
//  have free worker. put task into queue to let the worker deal with task. 
//  callback instance when async-call has exception thrown 
// If the `invoker` is in the  `selected` or invoker is unavailable && availablecheck is true, reselect. 
//  compile 
//  retry loop.   last exception.   invoked invokers. 
/*      * if {@link #key()} is specified, it will be used as the key for the annotated property when generating url.     * by default, this key will also be used to retrieve the config value:     * <pre>     * {@code     *  class ExampleConfig {     *      // Dubbo will try to get "dubbo.example.alias_for_item=xxx" from .properties, if you want to use the original property     *      // "dubbo.example.item=xxx", you need to set useKeyAsProperty=false.     *      @Parameter(key = "alias_for_item")     *      public getItem();     *  }     * }     *     * </pre>      */
// Cached invoker urls, convenient for comparison 
//  wildcard condition 
//  toMergeMethodInvokerMap() will wrap some invokers having different groups, those wrapped invokers not should be routed. 
//  release ClassGenerator 
//                       ^^ only tow slash! 
//  @@protoc_insertion_point(class_scope:Map) 
//  Unavailable codes mean the system will be right back.   (e.g., can't connect, lost leader)   Treat Internal codes as if something failed, leaving the   system in an inconsistent state, but retrying could make progress.   (e.g., failed in middle of send, corrupted frame) 
//  URL address separator, used in file cache, service provider URL separation 
//  return immediately if there's no change 
//  verify if it's idempotent 
//  @@protoc_insertion_point(message_implements:org.apache.dubbo.common.serialize.protobuf.model.PBResponseType) 
//  If there's no tagged providers that can match the current tagged request. force.tag is set by default 
//  List 
//  the total count 
/*          * The fill length can not be less than 256, because by default, hessian reads 256 bytes from the stream each time.         * Refer Hessian2Input.readBuffer for more details          */
//  Choose an invoker from all the least active invokers 
/*  the .properties file under 'configFile' is global shared while .properties under this one is limited only to this application     */
//  if client connect or disconnect to server, zookeeper will queue   watched event(Watcher.Event.EventType.None, .., path = null). 
//  Copy from javassist.bytecode.annotation.Annotation.createMemberValue(ConstPool, CtClass); 
//  must present 4 segments 
//  for CuratorZookeeperClient 
//  do refer 
//  given that repeat(String, int) is quite optimized, better to rely on it than try and splice this into it 
//  get URL directly 
//  use 1st key, key1 
//  limit input stream. 
//  test old @Activate group 
//  Double check whether or not it is connected 
/*  * Serialization strategy interface that specifies a serializer. (SPI, Singleton, ThreadSafe) * * The default extension is hessian2 and the default serialization implementation of the dubbo protocol. * <pre> *     e.g. &lt;dubbo:protocol serialization="xxx" /&gt; * </pre>  */
//  process all timeouts 
// The same invoker, exporter that multiple exported are different 
// exist overridden method 
//  override url with configurator from configurators from "service-name.configurators" 
//  fix issue#619 
//  create service proxy 
//  ======== protocol default values, it'll take effect when protocol's attributes are not set ======== 
//  then unregister 
//  never has a retry task. then start a new task for retry. 
//  property of list 
//  export to local if the config is not remote (export to remote only when config is remote) 
//  log output 
/*  * ValidationFilter invoke the validation by finding the right {@link Validator} instance based on the * configured <b>validation</b> attribute value of invoker url before the actual method invocation. * * <pre> *     e.g. &lt;dubbo:method name="save" validation="jvalidation" /&gt; *     In the above configuration a validation has been configured of type jvalidation. On invocation of method <b>save</b> *     dubbo will invoke {@link org.apache.dubbo.validation.support.jvalidation.JValidator} * </pre> * * To add a new type of validation * <pre> *     e.g. &lt;dubbo:method name="save" validation="special" /&gt; *     where "special" is representing a validator for special character. * </pre> * * developer needs to do * <br/> * 1)Implement a SpecialValidation.java class (package name xxx.yyy.zzz) either by implementing {@link Validation} or extending {@link org.apache.dubbo.validation.support.AbstractValidation} <br/> * 2)Implement a SpecialValidator.java class (package name xxx.yyy.zzz) <br/> * 3)Add an entry <b>special</b>=<b>xxx.yyy.zzz.SpecialValidation</b> under <b>META-INF folders org.apache.dubbo.validation.Validation file</b>. * * @see Validation * @see Validator * @see Filter * @see org.apache.dubbo.validation.support.AbstractValidation  */
//  do not increment in method beforeExecute! 
//  String property has two setting method.   skip setXXXBytes(com.google.protobuf.ByteString value) 
//         kryo.setReferences(false); 
// linux end 
//  connection events 
//  logger 
//  Fall back to class name as cache key, for backwards compatibility with custom callers. 
//  Record a failed registration request to a failed list, retry regularly 
//  subscribe 
//  get request id. 
//  for sending over wire 
//  onError callback 
//  The sequence would be: SystemConfiguration -> AppExternalConfiguration -> ExternalConfiguration -> AbstractConfig -> PropertiesConfiguration 
//  message header length 
//  Use Default implementation 
// proxieeClass = c; 
//  Generate and write a response. 
//  Wait a while for existing tasks to terminate 
//  check ping & pong at server 
//  Process string to char array for generic invoke   See   - https://github.com/apache/dubbo/issues/2003 
//  if it's a callback, create proxy on client side, callback interface on client side can be invoked through channel   need get URL from channel and env when decode 
//  Convert tickDuration to nanos. 
//  getUsers 
//  just add new valid channel to NettyChannel's cache 
//  Config Center should always being started first. 
// private int yyline; 
//  because the two interfaces are initialized, the ReferenceCountExchangeClient reference counter is 2 
//  Registers @Service Bean first 
/* package */
/*  * EventFilterTest.java * TODO rely on callback integration test for now  */
//  Not match comparison 
//  Append default category if absent 
//  Remove all annotated-classes that have been registered 
//  id 
//  if it's auto resize, then calculate the possible max width 
//  skip the setting method with Pb entity builder as parameter 
//  Use Map.newBuilder() to construct. 
//  The first time is inaccurate. 
// change by fengting listener   {"listener", "exporter.listener", "string", "", "", "", "", "", "", ""},  {"filter", "service.filter", "string", "", "", "", "", "", "", ""}, 
//  Local disk cache, where the special key value.registries records the list of metadata centers, and the others are the list of notified service providers 
//  ~ end of else 
//  is the concrete service name 
//  verify cache, same result is returned for multiple invocations (in fact, the return value increases   on every invocation on the server side) 
//  no separator is required for the first item 
//  check for required fields of primitive type, which can't be checked in the validate method 
//  destroy all the registries 
//  Ignore all the exceptions and wait for the next retry 
//  Bind 
//  protocol key is the first 
//  mark buffer is not empty 
//  ======================================================     tests start   ======================================================   
// to judge if we need to delay publish 
//  message like : XxxService , XxxService 10 , XxxService xxxMethod , XxxService xxxMethod 10 
//  Lock the registry access process to ensure a single instance of the registry 
//  @@protoc_insertion_point(outer_class_scope) 
//  @Adaptive example, do not specify a explicit key. 
//  policy 
//     ConcurrentMap<String, Channel> channels = new ConcurrentHashMap<String, Channel>(); 
//  getAndIncrement() When it grows to MAX_VALUE, it will grow to MIN_VALUE, and the negative can be used as ID 
//  Wait for connection 
//  unsubscribe. 
//             logger.warn(t.getMessage(), t);          } 
// message like : xxxMethod, xxxMethod 10 
//  File cache timing writing 
//  register 
//  server will close channel when server don't receive any heartbeat from client util timeout. 
//  
// exchangeClients[i] = Exchangers.connect(url,handler);
//  if bind ip is not found in environment, keep looking up 
//  monitor 
//  Other events are passed down directly 
//  by default, port to registry 
//  Windows backspace echo 
//  connection should be lazy 
//  Do not check whether the connection is successful or not, always create Invoker! 
//  if the pattern is subnet format, it will not be allowed to config port param in pattern. 
//  Notified services 
//  @@protoc_insertion_point(enum_scope:org.apache.dubbo.common.serialize.protobuf.model.PhoneType) 
//  trigger ArrayMerger 
//  no @Adaptive 
//  reference retry init will add url to urls, lead to OOM   user specified URL, could be peer-to-peer address, or register center's address. 
//  Delete Error 
//  Get the active number of the invoker 
//  one channel can have multiple callback instances, no need to re-export for different instance. 
//  fill in message length and header length 
//  callback limits 
//  one of the properties of an argument is an instance of URL. 
//  Sending a registration request to the server side 
//  The field define the zookeeper server , including protocol, host, port, username, password 
//  If The return value of "getName" method is not null 
//  backspace 
//  Convert Map to MutablePropertyValues 
//  TODO get from ConfigManager first, only create if absent. 
/*      * Decide which target extension to be injected. The name of the target extension is decided by the parameter passed     * in the URL, and the parameter names are given by this method.     * <p>     * If the specified parameters are not found from {@link URL}, then the default extension will be used for     * dependency injection (specified in its interface's {@link SPI}).     * <p>     * For example, given <code>String[] {"key1", "key2"}</code>:     * <ol>     * <li>find parameter 'key1' in URL, use its value as the extension's name</li>     * <li>try 'key2' for extension's name if 'key1' is not found (or its value is empty) in URL</li>     * <li>use default extension if 'key2' doesn't exist either</li>     * <li>otherwise, throw {@link IllegalStateException}</li>     * </ol>     * If the parameter names are empty, then a default parameter name is generated from interface's     * class name with the rule: divide classname from capital char into several parts, and separate the parts with     * dot '.', for example, for {@code org.apache.dubbo.xxx.YyyInvokerWrapper}, the generated name is     * <code>String[] {"yyy.invoker.wrapper"}</code>.     *     * @return parameter names in URL      */
//  FIX
//  20 is the default maxTotal of current PoolingClientConnectionManager 
//  reach the most times of retry. 
//  use RpcContextFilter
//  Construct using org.apache.dubbo.common.serialize.protobuf.model.GooglePB.PBResponseType.newBuilder() 
//  Create some data for test 
//  make sure null and base64 encoded string can work 
//  Expected
//  maxHistory=0 Infinite history 
// ctx.start(); 
//  Make sure all properties are copied. 
//  remove timeout that was either processed or cancelled by updating the linked-list 
//  The escape character preceding the delimiter start is   itself escaped: "abc x:\\{}"   we have to consume one backward slash 
//  directly throw if the exception appears in the signature 
// int idx = server.indexOf(':'); 
//  count down 
//  Convert parameters into map 
//  url to export locally 
//  split service name to segments   (required) segments[0] = category   (required) segments[1] = serviceInterface   (optional) segments[2] = version   (optional) segments[3] = group 
//  test message header length 
//  cancel refer, directly remove from the map 
//  unlikely but not impossible: read 0 characters, but not at end of stream 
// stop timer 
//  count up 
//  init notify listener 
/*                       The customized 'com.alibaba.dubbo.rpc.protocol.http.HttpRemoteInvocation' was firstly introduced                      in v2.6.3. The main purpose is to support transformation of attachments in HttpInvokerProtocol, see                      https://github.com/apache/dubbo/pull/1827. To guarantee interoperability with lower                      versions, we need to check if the provider is v2.6.3 or higher before sending customized                      HttpRemoteInvocation.                      */
//  by default, reference local service if there is 
// Merge the urls of configurators 
//  get return type 
//  transfer only max. 100000 timeouts per tick to prevent a thread to stale the workerThread when it just   adds new timeouts in a loop. 
//  Listeners list for subscribed services 
//  if null, will return the initialize value.  Assertions.assertNull(RpcContext.getContext()); 
//  delete listener and register 
// change db.index=1 
// .addParameter(Constants.STUB_KEY, RegistryServiceStub.class.getName()) 
//  cores theads are all alive. 
//  Sum 
//  Lock up the registry shutdown process 
/* registryDirectory.notify(serviceUrls);        RouterChain routerChain = registryDirectory.getRouterChain();        //default invocation selector        Assertions.assertEquals(1 + 1, routers.size());        Assertions.assertTrue(ScriptRouter.class == routers.get(1).getClass() || ScriptRouter.class == routers.get(0).getClass());        registryDirectory.notify(new ArrayList<URL>());        routers = registryDirectory.getRouters();        Assertions.assertEquals(1 + 1, routers.size());        Assertions.assertTrue(ScriptRouter.class == routers.get(1).getClass() || ScriptRouter.class == routers.get(0).getClass());        serviceUrls.clear();        serviceUrls.add(routerurl.addParameter(Constants.ROUTER_KEY, Constants.ROUTER_TYPE_CLEAR));        registryDirectory.notify(serviceUrls);        routers = registryDirectory.getRouters();        Assertions.assertEquals(0 + 1, routers.size()); */
//   subscription information to cover. 
// export stub service 
//  Record the weight the first least active invoker 
//  Just pick an available invoker using loadbalance policy 
/* , localContext */
//  make sure first time callback successfully 
// {"filter", "service.filter", "string", "", "", "", "", "", "", ""},  {"listener", "listener", "string", "", "", "", "", "", "", ""}, 
//  ExchangeClient client = arrays.get(0); 
//  ================ Array Type ================  
//  check the setter/getter whether match 
// If no mock was configured, return null directly 
// The origin invoker 
//  DUBBO-147 find all invoker instances which have been tried from RpcContext 
//  test netty client 
// {"mock", "mock", "string", "false", "dubbo.test.HelloServiceMock", "true", "", "", "", ""}, 
//  unlock 
//  create exception response. 
//  no-op 
//  escape 
//  unregister. 
//  no more variables   this is a simple string 
// private ChannelListener listener; 
//  range condition 
//  server supports reset, use together with override 
//  2.0.2 
//  use CompareAndSet to sum 
//  timeout in 15 seconds. 
//  process width cache 
//         // get arguments          Object arguments = ReflectionUtil.parseArguments(                  invocation.getMethod(), invocation.getArguments(), useNamedParams);            // invoke it          return jsonRpcHttpClient.invoke(                  invocation.getMethod().getName(),                  arguments,                  retType, extraHttpHeaders);
//  clear buffer 
//  init decoder map. 
//  Ignore it. 
//  init the object 
/*  * Autogenerated by Dubbo Compiler (0.1.0) * <p> * Thrift (0.7.0) * <p> * DO NOT EDIT UNLESS YOU ARE SURE THAT YOU KNOW WHAT YOU ARE DOING  */
//  ======================================================     data table manipulation utils 
//  Sending a canceling subscription request to the server side 
//  ignore error log 
//  bind ip is used as registry ip by default 
//  Allow to access   local reference 
//  @@protoc_insertion_point(interface_extends:Map) 
//  It's safe to declare it as singleton since it runs on single thread only 
//  remain 
//  find parameterized type 
//  @@protoc_insertion_point(builder_implements:Map) 
//  get translated positions and possibly new buffer 
//  Null point check 
//  do nothing 
//         testStartupConfig();          testProviderConfig();          testPathCache();          testTreeCache();          testCuratorListener();         Thread.sleep(100000); 
//  2. if there are some addresses that are not in any dynamic tag group, continue to filter using the   static tag group. 
//  Each invoke has the same weight (only one invoker here) 
//  connection error causes client to release all resources including current watcher
//  assert tags 
//  If it is the first invoker or the active number of the invoker is less than the current least active number 
//  verify if the first cache item is expired in LRU cache 
//  contributors: lizongbo: proposed special treatment of array parameter values   Joern Huxhorn: pointed out double[] omission, suggested deep array copy 
//  @Parameter(key="key2", useKeyAsProperty=true) 
//         URL consumerurl = serviceurl;          Invoker<DemoService> reference = protocol.refer(DemoService.class, consumerurl);          DemoService demoProxy = (DemoService)proxyFactory.createProxy(reference); 
// configure the cache 
// ignore overloaded method 
//  export one service 
//  Initialize the startTime. 
//             {"", "", "", "", "", "", "", "", "", ""}, 
//  loop up after registry 
//  get version. 
// Header 
//  need to consider backward-compatibility if it's a callback 
//  enable heartbeat by default 
// excluded = true              {"filter", "service.filter", "string", "default", "-generic", "", "", "", "", ""},  excluded = true              {"listener", "exporter.listener", "string", "default", "-deprecated", "", "", "", "", ""},  {"", "", "", "", "", "", "", "", "", ""}, 
//  backward compatibility for version 2.0.0 
//  print inner separation lines 
/*                                          *  because etcd3 does not support direct children watch events,                                         *  we should filter not interface events. if we watch /dubbo                                         *  and /dubbo/interface, when we put a key-value pair {/dubbo/interface/hello hello},                                         *  we will got events in watching path /dubbo.                                          */
//  Save OK 
//  return url.getServiceKey(); 
//  Merge the consumer side parameters 
//  empty protocol 
//  valid port range is (0, 65535] 
//  when return type is not the subclass of return type from the signature and not an interface 
//  default time-to-live in millisecond 
//  service name   method name 
// int port = (int) (1000 * Math.random() + 10000); 
/*  index in packed string   */
//  Remove configurations from provider, some items should be affected by provider. 
//  Do not need to close
//  get cache by class loader. 
//  No matching results 
//  check if methods exist in the remote service interface 
//  create XmlRpcHttpClient 
//  Initialization at construction time, assertion not null   Initialization at construction time, assertion not null   Initialization at construction time, assertion not null   Initialization at construction time, assertion not null, and always assign non null value 
//  cached fields: 
//  present in both local and remote, but uses remote value. 
//  use 1st key, protocol 
//  3. - setRepeatedField(com.google.protobuf.Descriptors.FieldDescriptor field,int index,java.lang.Object value） 
//  pop name. 
// invoke method --> init client 
//  loop methods, get override value and set the new value back to method 
// onthrow callback not configured
//  @@protoc_insertion_point(class_scope:org.apache.dubbo.common.serialize.protobuf.model.PhoneNumber) 
//  reset 
//  Close old channel   copy reference 
//  Construct using org.apache.dubbo.common.serialize.protobuf.model.GooglePB.PBRequestType.newBuilder() 
//  Custom type 
//  application 
// decode 
// init channel 
//  set request and serialization flag. 
//  to verify interfaceClass is an interface 
// Clear first, previous test case will make sure that the right invoker2 will be used. 
//  get stackTrace value 
//  remove group: "module-x.y.z" 
// value calculate 
// Configured with mock 
// The parameters are different and must be rereferenced. 
//  never select invoker3 because it's active is more than invoker1 and invoker2 
//  appender 
//  Append first page into list 
/*  Windows Enter  */
//  do refer duplicated 
//  counters 
//  treat url and configuration differently, the value should always present in configuration though it may not need to present in url. 
//  If more than 1 page 
//  print first separation line 
//  no need to generate adaptive class since there's no adaptive method found.
//  array begin. 
// when both mismatches and matches contain the same value, then using mismatches first 
//  Primitive type 
//  HeaderExchangeChannel.removeChannelIfDisconnected(channel); 
// this will throw a exception
//  ~ end of if 
//  string   int   override 
//  default db.index=0 
//  send error message to Consumer, otherwise, Consumer will wait till timeout. 
//  object begin. 
//  if the timeout is the tail modify the tail to be the prev node. 
// The listener of the consumer and the provider can be stored together, all based on the service name 
/* client.request("world\r\n");        Future future = client.request("world", 10000);        String result = (String)future.get();        Assertions.assertEquals("Did you say 'world'?\r\n",result); */
//  returns current version of Response to consumer side. 
//  DemoServiceImpl with @Transactional 
//  load classes 
//  Generated by the protocol buffer compiler.  DO NOT EDIT!   source: GooglePB.proto 
//  Test filter condition 
//  Registers ReferenceAnnotationBeanPostProcessor 
//  need separator for others 
//  read server info from property 
//  if field name end with List, should skip 
//  The combination of directoryUrl and override is at the end of notify, which can't be handled here 
/*  index in unpacked array  */
//  For providers, this is used to enable custom proxy to generate invoker 
// ////////////////////////////////////////////////////////// 
//  forbid 
// first add into the list   remove the individul param 
//  this is only for compatibility 
//  Cache check interval (second) 
//  return 404 when fail to construct command context 
// windows end 
// zzEOFDone = false; 
//  has pad char. 
//  alignment 
//  token type 
// tmperately add a new invoker 
//  if invoker is destroyed due to address refresh from registry, let's allow the current invoke to proceed 
//  we use the loading status of DynamicConfiguration to decide whether ConfigCenter has been initiated. 
//  refresh all configs here, 
//  property defined as "repeated string" transform to ProtocolStringList,   should be build as List<String>.
// Ensure that a new exporter instance is returned every time export 
//  write array. 
//  set thread pool. 
//  registry 
//  The Value in the KV part. 
// override clean 
//  ================ Primitive Type ================  
// throw  ChannelEventRunnable.runtimeExeception(int logger) not in execute exception  (expected = RemotingException.class) 
//  find version info from MANIFEST.MF first 
//  save for 2.6.x compatibility, for example, TraceFilter in Zipkin uses com.alibaba.xxx.FutureAdapter 
//  Use PhoneNumber.newBuilder() to construct. 
//  this is used for tracing if instid has published service or not. 
//             + "&"+Constants.CHANNEL_HANDLER_KEY+"=connection" 
//  prevents grpc on sending error to a closed watch client. 
//  format: "pid@hostname" 
//  References "ref" property to annotated-@Service Bean 
//  Config center has the highest priority 
//  Must be even 
//  do not touch this method, if you want terminate this stream. 
//  Publish ServiceBeanExportedEvent 
//  client can expose a service for server to invoke only. 
//  Combine filters and listeners on Provider and Consumer 
//  make the grpc call to watch the key 
// bad object 
//  the weight of every invokers 
//  The weight of the first least active invoker 
//  Normalize ticksPerWheel to power of two and initialize the wheel. 
// encode resault check need decode 
//  TODO figure out the meaning of cancel in DefaultFuture. 
/*      * get map property name from setting method.<br/>     * ex: putAllXXX();<br/>     *     * @param methodName     * @return      */
//  If @Service bean is local one 
//  bad request 
//  client has been replaced with lazy client. lazy client is fetched from referenceclientmap, and since it's 
//  add scene judgement in windows environment Fix 2557 
//  alive 1 second 
//  collect timer for collecting statistics data 
//  Decide to fail or to continue when failed to connect to remote server. 
//  result field id is 0 
//  handle response. 
//  For test 
//  header length 
//  add fields 
//  1. all addresses are in dynamic tag group, return empty list. 
//  remove 'default.' prefix for configs from ProviderConfig   appendParameters(map, provider, Constants.DEFAULT_KEY); 
/*  finally: fill the buffer with new input  */
// Assertions.assertEquals("properties", overrideConfig.getUseKeyAsProperty()); 
//  service3 interface is not equals server2 
//  Was cancelled in the meantime. 
/* ------------------------------------test invokers for weight--------------------------------------- */
//  Registry Collection Map<RegistryAddress, Registry> 
//  registry ip is not used for bind ip by default 
//  ignore, there is no need any log here since some class implement the interface: EnvironmentAware,   ApplicationAware, etc. They only have setter method, otherwise will cause the error log during application start up. 
// create a real instance to keep the attribute values; 
//  Forbid to access 
//  parse setXXX(String string) 
//  add the tail string which contains no variables and return   the result. 
//  process imported classes 
//  First, pick the invoker (XXXClusterInvoker) that comes from the local registry, distinguish by a 'default' key. 
//  if our future is success, mark the future to sent. 
//  present in local url but not in remote url, parameters of remote url is empty 
//  config 
//  Finds all BeanDefinitionHolders of @Service whether @ComponentScan scans or not. 
//  Exactly one method, match 
/*  Linux Ctrl+C  */
//  whether the channel is closed 
//  Rethrow exception 
//  then destroy, the multicast socket will be closed 
//         Assertions.assertEquals(                  serviceURL.setPath(service).addParameters("check", "false", "interface", DemoService.class.getName(), REMOTE_APPLICATION_KEY, serviceURL.getParameter(APPLICATION_KEY))                  , invokers.get(0).getUrl()          ); 
//  Translate url list to Invoker map 
//  check if the output is generated by a fixed way 
//  Alarm when spare memory < 2M 
//  Reconnecting detection cycle: 3 seconds (unit:millisecond) 
//  @@protoc_insertion_point(message_implements:Map) 
//  set request id. 
//  encode request data. 
//  clear attachments which is binding to current thread. 
//  jcache parameter is the full-qualified class name of SPI implementation 
//  merge - configuration 
// RegistryController.startRegistryIfAbsence(1); 
//  decrease any way 
//  isTypeMatch() is called to avoid duplicate and incorrect update, for example, we have two 'setGeneric' methods in ReferenceConfig. 
// After pushing two provider, the directory state is restored to true 
//  default watch timeout in millisecond 
//  special logic for enum 
//  destroy all the protocols 
// get real invoked method name from invocation 
//  Refresh Dubbo Environment 
/*  error messages for the codes above  */
//  send statistics data 
//  decode request. 
//  filter general setting method   1. - setUnknownFields( com.google.protobuf.UnknownFieldSet unknownFields)   2. - setField(com.google.protobuf.Descriptors.FieldDescriptor field,java.lang.Object value) 
//  add dynamic class tag. 
//  check extName == null?
//  write 
//  attachment will be bind to invocation 
//  Because javassist compiles using the caller class loader, we should't use HelloService directly 
// future.cancel(true); 
//  Test multiple binding 
//  notify flag 
//     @Test 
//  system may be recover later, current connect won't be lost 
//  host is the same, sort by priority 
//  Scheduled executor service 
//  use interface's name as service path to export if it's not found on client side 
//  whether to share connection 
// ClassLoader - ClassPool 
//  the latest latch just for 3. Because retry method has been removed. 
//  Start server 
//  Initially disable 
//  all processed 
// callback 
// TODO SoftReference 
//  required 
// If the telnet data and request data are in the same data packet, we should guarantee that the receipt of request data won't be affected by the factor that telnet does not have an end characters. 
//  Reset the active number of the current invoker to the least active number 
//  copy -> modify -> update reference 
//  value is not set, use the value generated from class name as the key 
//  create Mixin class. 
//                 protocol.readI32(); // skip the first message length 
//  use 2nd key, protocol 
//  say name 
//  end of object. 
// this.handler = null; 
//  export service. 
//  The name of bean annotated @Service 
//     private final boolean isCallBack;      private final boolean isFuture; 
/*      * This is used to convert a configuration nodePath into a key     * TODO doc     *     * @param path     * @return key (nodePath less the config root path)      */
//  If current invoker's active value equals with leaseActive, then accumulating. 
//  ~ 
//  local injvm and registry protocol, so expected is 2 
//                             activeLimitFilter.listener().onError(expected, invoker, invocation); 
//  If the startup detection is opened, the Exception is thrown directly. 
//  get users 
// has nothing use 
/*  ignore  */
// Enabled by override rule 
//  end of methods for 
//  @Test 
//  directly throw if it's checked exception 
// test geturl 
//  find server. 
//  Port   Append backup parameter as other servers 
//  service scope by default. 
//  because helloServiceInvoker and demoServiceInvoker use share connect， so client list must be equal 
//  returned port range is [30000, 39999] 
//  ID 
//  we want these objects to be as generic as possible 
// sticky: invoker.isAvailable() should always be checked before using when availablecheck is true. 
//  Log output 
//  currently, the version value in Response records the version of Request 
//  The lock for the acquisition process of the registry 
// TODO response test 
//  @@protoc_insertion_point(class_scope:org.apache.dubbo.common.serialize.protobuf.model.PBResponseType) 
// Note the implicit contract (although the description is added to the interface declaration, but extensibility is a problem. The practice placed in the attachment needs to be improved)
//  Initialization at construction time, assertion not null, and always assign non null value 
// Assertions.assertEquals(ThriftCodec.getSeqId(), message.seqid); 
// local invoke will return directly 
//           invoker.destroy();          reference.destroy(); 
//  add implemented interfaces 
//  parse setXXX(com.google.protobuf.Message value) 
//  create MixinInstance class. 
//  by default, host to registry 
//  If a method doesn't have a merger, only invoke one Group 
//  test chinese 
/*  List routers = registryDirectory.getRouters();        Assertions.assertEquals(1 + 1, routers.size());        serviceUrls.clear();        serviceUrls.add(routerurl.addParameter(Constants.ROUTER_KEY, Constants.ROUTER_TYPE_CLEAR));        registryDirectory.notify(serviceUrls);        routers = registryDirectory.getRouters();        Assertions.assertEquals(0 + 1, routers.size()); */
//  for backward compatibility 
//  found parameter in URL type 
//  reput this task when catch exception. 
//  assert addresses 
//  If (not every invoker has the same weight & at least one invoker's weight>0), select randomly based on totalWeight. 
/*      * get list property name from setting method.<br/>     * ex： getXXXList()<br/>     *     * @param methodName     * @return      */
// .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, getTimeout()) 
//  TODO optimization 
//  return false to let executor create new worker. 
//  3 invoker notifications=================================== 
// {"local", "local", "string", "false", "HelloServiceLocal", "true", "", "", "", ""},  {"local", "local", "string", "false", "true", "", "", "", "", ""}, 
//  Fixed router instances: ConfigConditionRouter, TagRouter, e.g., the rule for each instance may change but the 
// test unsubscribe 
//  return default version when any exception is thrown 
// directory will return a list of normal invokers if Constants.INVOCATION_NEED_MOCK is present in invocation, otherwise, a list of mock invokers will return. 
//  add heartbeat cycle to avoid unstable ut. 
//  Prevent JVM from exiting 
//  Prevent overflow. 
//  don't export when none is configured 
//  test value 
//  #2 ReferenceBean (Field Injection #1) 
//  From Child 
//  local variable, convenient for debug 
// Thread.sleep(20000); 
// Need to be restored to the original providerUrl
//  proceed invocation chain 
//  due to the effect of LazyConnectExchangeClient, the client will be "revived" whenever there is a call. 
//  Output, tps is not for accuracy, but it reflects the situation to a certain extent. 
//  TODO 
//  Can be unset. 
//  getDesc 
//  Compatible version 1.0  fix by tony.chenl DUBBO-44 
//  init encoder map. 
//  indent length 
//  The last two parameters are reserved for compatibility with the old configuration 
// no mock 
//  registry url is available   use RegistryAwareCluster only when register's CLUSTER is available 
//  e.g., version number 2.6.3 will convert to 2060300 
//  we only process String properties for now 
//  This object is going to be GCed and it is assumed the ship has sailed to do a proper shutdown. If   we have not yet shutdown then we want to make sure we decrement the active instance count. 
//  TODO add this to provider config
//  Test username or password contains "@" 
//  No Category Parameter 
//  you can customize name and type of client thread pool by THREAD_NAME_KEY and THREADPOOL_KEY in CommonConstants.   the handler will be warped: MultiMessageHandler->HeartbeatHandler->handler 
//  callback instance when async-call is returned 
//  export service 
//  no need to new client again 
/*  The group of the config center, generally it's used to identify an isolated space for a batch of config items,    but it's real meaning depends on the actual Config Center you use.     */
//  The null value unallowed in the ConcurrentHashMap. 
//  Set ignored* 
// To solve the problem of RMI repeated exposure port conflicts, the services that have been exposed are no longer exposed.  providerurl <--> exporter 
//  create proxy 
//     private boolean isExternalServer; 
// header 
// if local service interface's method's return type is not instance of return value 
// test one unregister 
//  Get the weight of the invoker's configuration. The default value is 100. 
// content 
//  add default extension 
//  not allow to save null, but allow to update with null which means not update the field 
//  Queue 
//  ~ end of loop field map 
//  connectNum must be greater than or equal to 1 
//  it doesn't seem like you should have to do this, but java serialization is wacky, and doesn't call the default constructor. 
//  ip:port -> ExchangeServer 
// 32 8 first add space and then add backspace. 
//  ~ end of catch 
//  maybe url has many subscribed paths 
//  check duplicate jar package 
//  store back cached positions 
//  Sending a subscription request to the server side 
// .addLast("logging",new LoggingHandler(LogLevel.INFO))//for debug 
//  decrease Time 
//  Type of handle 
//  use last registry url 
//  currently we use a single header to hold the attachments so that the total attachment size limit is about 8k 
//  create ProxyInstance class. 
//  default value is true 
//  @@protoc_insertion_point(message_implements:org.apache.dubbo.common.serialize.protobuf.model.PBRequestType) 
//  ================ Complex Collection Type ================  
//  @@protoc_insertion_point(message_implements:org.apache.dubbo.common.serialize.protobuf.model.PhoneNumber) 
//  get operate will throw a timeout exception, because the future is timeout. 
// excluded = true 
//  backward compatibility for the default value in old version's xsd 
//  Check whether or not it is connected 
//  cache time (second) 
//  If the local @Service Bean exists, build a proxy of ReferenceBean 
//  If no mock was configured, return null directly 
//  module 
// export an stub service for dispatching event 
//  Customized parameters 
//  ======================================================     data column definition 
// convert error fail fast .  ignore concurrent problem. 
// result dependent on method order. 
// Test the matching of protocol and select only the matched protocol for refer 
//  ignore NoNode Exception.
//  ---- for service provider ---- 
//  if this file exist, firstly delete it. 
//  check parameters 
// export invoker 
//  check for required fields   alas, we cannot check 'id' because it's a primitive and you chose the non-beans generator.   check for sub-struct validity
// Check if the localClass a constructor with parameter who's type is interfaceClass 
//  load 
// 00000010-response/oneway/hearbeat=false/hessian |20-stats=ok|id=0|length=0 
//  blocking 
//  if we are requesting for a Provider with a specific tag 
//  pass attachments to result 
//  ====================================================== 
//  here a three shared connection is established between a consumer process and a provider process. 
//  target the method, and get its signature 
//  no methods 
//  Is it synchronized to save the file
//  URL cannot be transferred automatically from the server side to the client side by using API, instead,   it needs manually specified.
//         provConf.setApplication(appConfForProvider); 
//  may have concurrency issue 
//  stores the configuration key-value pairs 
//  the scope for referring/exporting a service, if it's local, it means searching in current JVM only. 
// Failure can not be called to listener. 
//  Let the client not reply to the heartbeat, and turn off automatic reconnect to simulate the client dropped. 
//  group="a,b" or group="*" 
// just for connected 
//  continue 
//  We will update our cache file after each notification.   When our Registry has a subscribe failure due to network jitter, we can return at least the existing cache URL. 
//  protocol 
//  consumer 
//  we may already added some attachments into RpcContext before this filter (e.g. in rest protocol) 
//  check if recover successfully 
//  only update the state it will be removed from HashedWheelBucket on next tick. 
//  handle request. 
//  Mark the client into the closure process 
//  Register CustomEditors for special fields 
//  getName 
//  message length placeholder 
//  We will check enabled status inside each router. 
//  default cache.size is 1000 for LRU, should have cache expired if invoke more than 1001 times 
//  get statistics data 
//  Registered services 
//  save any parameter in registry that will be useful to the new url. 
//  abnormal case  
//  Quick check on the concurrent map first, with minimal locking. 
//  if result is not null OR it's null but force=true, return result directly 
//  Transform File URL into Script Route URL, and Load   file:///d:/path/to/route.js?router=script ==> script:///d:/path/to/route.js?type=js&rule=<file-content>   Replace original protocol (maybe 'file') with 'script'   Use file suffix to config script type, e.g., js, groovy ... 
//  remove suffix ".jar": "path/to/group-module-x.y.z" 
// 00000010-response/oneway/hearbeat=true |20-stats=ok|id=0|length=0 
//  default or set void.class for purpose. 
/*  * Marker for extension interface * <p/> * Changes on extension configuration file <br/> * Use <code>Protocol</code> as an example, its configuration file 'META-INF/dubbo/com.xxx.Protocol' is changes from: <br/> * <pre> *     com.foo.XxxProtocol *     com.foo.YyyProtocol * </pre> * <p> * to key-value pair <br/> * <pre> *     xxx=com.foo.XxxProtocol *     yyy=com.foo.YyyProtocol * </pre> * <br/> * The reason for this change is: * <p> * If there's third party library referenced by static field or by method in extension implementation, its class will * fail to initialize if the third party library doesn't exist. In this case, dubbo cannot figure out extension's id * therefore cannot be able to map the exception information with the extension, if the previous format is used. * <p/> * For example: * <p> * Fails to load Extension("mina"). When user configure to use mina, dubbo will complain the extension cannot be loaded, * instead of reporting which extract extension implementation fails and the extract reason. * </p> * * @deprecated because it's too general, switch to use {@link org.apache.dubbo.common.extension.SPI}  */
//  wait timeout ms 
// return directly 
//  Initialize 
//  TODO carries class info every time. 
//  mock zookeeper://xxx?mock=return null 
//  invoke 
//  Username to login register center 
//  Check the number of skipping times 
//  interface cannot be null 
//  override url don't have a port, means the ip override url specify is a consumer address or 0.0.0.0   1.If it is a consumer ip address, the intention is to control a specific consumer instance, it must takes effect at the consumer side, any provider received this override url should ignore;   2.If the ip is 0.0.0.0, this override url can be used on consumer, and also can be used on provider 
//  ~ end of method serializeInternal 
//  Try the next server 
//  Instead of using Dubbo's configuration, I would suggest use the original configuration method Apollo provides.
// private String host; 
//  whether to auto resize 
//  name2desc 
//  take effect on all providers, so address must be 0.0.0.0, otherwise it won't flow to this if branch 
// Test retries and 
// just for one method 
//  scheduled executor service 
//  Process return type. 
//             {"timeout", "registry.timeout", "int", 5000, 9000, "", "", "", "", ""},              {"file", "registry.file", "string", "", "regConfForServiceTable.log", "", "", "", "", ""},              {"wait", "registry.wait", "int", 0, 9000, "", "", "", "", ""},              {"transport", "registry.transporter", "string", "netty", "mina", "", "", "", "", ""},              {"subscribe", "subscribe", "boolean", true, false, "", "", "", "", ""}, 
//  message length 
//  short name condition 
// TODO to calculate consumerAddressNum 
//  add method, for verifying against method, automatic fallback (see dubbo protocol) 
//  ==== Template method ==== 
//  Test filter won't throw an exception 
//  put into waiting map. 
//  end of array. 
//  clear first 
//  Method routing and Other condition routing can work together 
//  <method desc,method instance>   <constructor desc,constructor instance> 
//  Since 2.6.6 https://github.com/apache/dubbo/issues/3193 
//  TODO for now just do plain text output
//  Since injvm protocol is configured explicitly, we don't need to set any extra flag, use normal refer process. 
//  isset id assignments 
// All of them are called 4 times. A successful attempt to lose 1. subscribe will not be done 
//  parse setXXX(SomeEnum value) 
//  ServiceBean Bean name 
//     private PropertyInjector propertyInjector;      private String context = null; 
//  to notify configurator/router changes 
//  use 'zookeeper' as the default configcenter. 
//  Add methods parameters 
//  enable sending readonly event when server closes by default 
//  append the characters following the last {} pair. 
//  Check if "serialization id" passed from network matches the id on this side(only take effect for JDK serialization), for security purpose. 
// The anyhost parameter of override may be added automatically, it can't change the judgement of changing url 
//  Get properties under specified prefix from PropertySources 
//  Reset totalWeight 
//  DO NOTHING 
//  Reconnection timer, regular check connection is available. If unavailable, unlimited reconnection. 
//  need to configure if there's return value before the invocation in order to help invoker to judge if it's   necessary to return future.
//  override url with configurator from configurator from "app-name.configurators" 
//  No content , ignore directly 
//  impossible 
//  Local disk cache file 
//  TODO how to assert thread action
//  if not auto resize, return preset width 
// =================================================================================== 
//  @@protoc_insertion_point(builder_implements:org.apache.dubbo.common.serialize.protobuf.model.PBRequestType) 
// All service providers can not be disabled through override. 
//  biz exception. 
// One is the same, one is different 
//  create a new List of invokers 
//  timeout check 
//  keep every provider's category. 
//  otherwise, wrap with RuntimeException and throw back to the client 
//  Remove ServiceBean when it's exported 
//  the number of pages 
// init request string 
// not set onreturn callback 
//  BAD
// final int concurrent = PerformanceUtils.getIntProperty("concurrent", 100);  int r = PerformanceUtils.getIntProperty("runs", 10000);  final int runs = r > 0 ? r : Integer.MAX_VALUE; 
//  ================ Simple Type ================  
//  register service3 should not trigger notify
//  idleTimeout should be at least more than twice heartBeat because possible retries of client. 
//  local reference 
//  use 2nd key, key2 
// ============================================================================================================================= 
//         String serviceStr = ""; 
//  ~ end of loop serverMap 
//  [Issue] SpringStatusChecker execute errors on non-XML Spring configuration   issue : https://github.com/apache/dubbo/issues/3615   ignore GenericXmlApplicationContext
//  magic header. 
//  test recover nothing 
//  1. fill corresponding config with data 
//  receive a new packet   buffer 
//  The sum of the warmup weights of all the least active invokers 
//  Cache key is url that does not merge with consumer side parameters, regardless of how the consumer combines parameters, if the server url changes, then refer again 
//         server.getDeployment().getMediaTypeMappings().put("xml", "application/xml"); 
//   a method start with $ is illegal in soap          // cast to EchoService          EchoService echo = proxy.getProxy(protocol.refer(EchoService.class, URL.valueOf("webservice://127.0.0.1:9010/" + DemoService.class.getName() + "?client=netty"))); 
//  Map<serviceName, Map<url, queryString>> 
// record change 
//  frame 
//  If we got exactly one invoker having the least active value, return this invoker directly. 
//  @@protoc_insertion_point(builder_scope:org.apache.dubbo.common.serialize.protobuf.model.PhoneNumber) 
//  Get PropertySource mapped to 'application.dubbo.properties' in Spring Environment. 
//         Thread.sleep(10000000); 
//         java.util.Iterator<Registry> registryIterable = multipleRegistry.getServiceRegistries().values().iterator();          Registry firstRegistry = registryIterable.next();          Registry secondRegistry = registryIterable.next(); 
//  if there's no bind port found from environment, keep looking up. 
//  excluded 
//  find URL getter method 
//  Subscribe logic guarantees the first notify to return 
//  java.lang.IllegalArgumentException: argument type mismatch 
//         URL serviceUrl2 = URL.valueOf("http2://multiple2/" + SERVICE_NAME + "?notify=false&methods=test1,test2&category=providers"); 
//  column width 
/*  * Marker for extension interface * <p/> * Changes on extension configuration file <br/> * Use <code>Protocol</code> as an example, its configuration file 'META-INF/dubbo/com.xxx.Protocol' is changed from: <br/> * <pre> *     com.foo.XxxProtocol *     com.foo.YyyProtocol * </pre> * <p> * to key-value pair <br/> * <pre> *     xxx=com.foo.XxxProtocol *     yyy=com.foo.YyyProtocol * </pre> * <br/> * The reason for this change is: * <p> * If there's third party library referenced by static field or by method in extension implementation, its class will * fail to initialize if the third party library doesn't exist. In this case, dubbo cannot figure out extension's id * therefore cannot be able to map the exception information with the extension, if the previous format is used. * <p/> * For example: * <p> * Fails to load Extension("mina"). When user configure to use mina, dubbo will complain the extension cannot be loaded, * instead of reporting which extract extension implementation fails and the extract reason. * </p>  */
//  check magic number. 
// try-with-resources 
//  If there is a client in the list that is no longer available, create a new one to replace him. 
//  if timeout is also the tail we need to adjust the entry too 
//  remove if not accept 
//  Multiple values 
//  #4 ReferenceBean (Field Injection #2) 
//             channel.close(); 
//  Number of invokers 
//  binding attachments into invocation. 
// test subscribe 
/*  request|1111...|request  */
//  this will not override, use 'key' instead, @Parameter(key="key1", useKeyAsProperty=false) 
//  Just read one server's data 
//  assemble URL from register center's configuration   if protocols not injvm checkRegistry 
//  process GET request and POST request separately. Check url for GET, and check body for POST 
//  add into default group 
//  Delete OK 
//  set response status. 
//  Guard against overflow. 
//  resolve future.awaitUninterruptibly() dead lock 
//  reference should not be null, and is the implementation of the given interface
//         final String canonicalName = clazz.getCanonicalName(); 
//  We add listeners to make sure our out bound event is correct.   If our out bound event has an error (in most cases the encoder fails),   we need to have the request return directly instead of blocking the invoke process. 
//  Port 
//  FAILOVER: return all Providers without any tags.
//  add initial values 
//  re-throws the actual Exception. 
//         consumerConf.setApplication(appConfForConsumer); 
// Assertions.assertEquals(proxy.hashCode(), invoker.hashCode()); 
//  Extend the expiration time   Defensive fault tolerance 
//  dynamic tag group doesn't have any item about the requested app OR it's null after filtered by   dynamic tag group but force=false. check static tag 
/*  indicate end of file  */
//  String[] to Map 
// queue.size  
//  register Alias rather than a new bean name, in order to reduce duplicated beans 
//  control char. 
//  mark buffer is used, exit mark status! 
//  Single Config Bindings 
//  Every least active invoker has the same weight value?
//  never return 0 even if n1 equals n2, otherwise, o1 and o2 will override each other in collection like HashSet 
